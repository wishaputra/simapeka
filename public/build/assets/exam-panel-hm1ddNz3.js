document.addEventListener("DOMContentLoaded",function(){const n=document.getElementById("addExamForm"),o=document.getElementById("editExamForm"),c=new bootstrap.Modal(document.getElementById("editExamModal")),i=document.querySelectorAll(".deleteExamBtn"),l=document.querySelectorAll(".editExamBtn"),d=document.querySelector('meta[name="csrf-token"]').getAttribute("content");n&&n.addEventListener("submit",function(a){a.preventDefault();const r=new FormData(n);fetch(n.action,{method:"POST",headers:{"X-CSRF-TOKEN":d},body:r}).then(e=>e.json()).then(e=>{e.success?window.location.reload():alert("Failed to add exam: "+e.message)}).catch(e=>{console.error("Error adding exam:",e),alert("An error occurred while adding the exam.")})}),l.forEach(a=>{a.addEventListener("click",function(){const r=this.dataset.id,e=this.dataset.title,s=this.dataset.passing_score,t=this.dataset.duration,m=this.dataset.max_attempts;o.querySelector("#editExamId").value=r,o.querySelector("#editExamTitle").value=e,o.querySelector("#editPassingScore").value=s,o.querySelector("#editDuration").value=t,o.querySelector("#editMaxAttempts").value=m,c.show()})}),o&&o.addEventListener("submit",function(a){a.preventDefault();const r=o.querySelector("#editExamId").value,e=document.getElementById("courseId").value,s=new FormData(o);fetch(`/dev/corpu2/simapeka/public/courses/${e}/exams/${r}`,{method:"POST",headers:{"X-CSRF-TOKEN":d,"X-HTTP-Method-Override":"PUT"},body:s}).then(t=>{if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return t.json()}).then(t=>{t.success?window.location.reload():alert("Failed to edit exam: "+t.message)}).catch(t=>{console.error("Error editing exam:",t),alert("An error occurred while editing the exam. Please try again.")})}),i.forEach(a=>{a.addEventListener("click",function(){const r=this.dataset.id;confirm("Are you sure you want to delete this exam?")&&fetch(`/dev/corpu2/simapeka/public/exams/${r}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":d}}).then(e=>e.json()).then(e=>{e.success?window.location.reload():alert("Failed to delete exam: "+e.message)}).catch(e=>{console.error("Error deleting exam:",e),alert("An error occurred while deleting the exam.")})})})});
