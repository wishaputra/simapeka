$(document).ready(function(){const i=$("#userListTable").DataTable({processing:!0,serverSide:!0,responsive:!0,ajax:{url:"/dev/corpu2/simapeka/public/pegawai/data",type:"GET"},columns:[{data:"DT_RowIndex",name:"DT_RowIndex",orderable:!1,searchable:!1},{data:"nip",name:"nip"},{data:"nama",name:"nama"},{data:"jabatan",name:"jabatan"},{data:"unit_kerja",name:"unit_kerja"},{data:"uptd",name:"uptd"},{data:null,orderable:!1,searchable:!1,render:function(a,e,t){return`
                        <button class="btn btn-sm btn-warning edit-user" data-id="${t.id}" data-bs-toggle="modal" data-bs-target="#editUserModal">
                            Edit
                        </button>
                    `}}]});$("#userListTable").on("click",".edit-user",function(){const a=$(this).data("id");$.ajax({url:`/dev/corpu2/simapeka/public/pegawai/${a}/edit`,type:"GET",success:function(e){$("#editUserModal #editNip").val(e.nip),$("#editUserModal #editNama").val(e.nama),$("#editUserModal #editJabatan").val(e.jabatan),$("#editUserModal #editUnitKerja").val(e.unit_kerja),$("#editUserModal #editUPTD").val(e.uptd),$("#editUserModal").data("id",a),$.ajax({url:"/dev/corpu2/simapeka/public/roles",type:"GET",success:function(t){const d=$("#editUserModal #editRole");d.empty(),t.forEach(r=>{e.id_role,r.id,d.append(`<option value="${r.id}">${r.role}</option>`)})},error:function(){alert("Failed to fetch roles.")}})},error:function(){alert("Failed to fetch user data.")}})}),$("#editUserForm").on("submit",function(a){a.preventDefault();const e=$("#editUserModal").data("id"),t={id_role:$("#editRole").val(),_token:$('meta[name="csrf-token"]').attr("content")};$.ajax({url:`/dev/corpu2/simapeka/public/pegawai/${e}`,type:"PUT",data:t,success:function(d){$("#editUserModal").modal("hide"),i.ajax.reload(null,!1),alert("User role updated successfully!")},error:function(){alert("Failed to update user role.")}})})});
