document.addEventListener("DOMContentLoaded",()=>{const r=document.getElementById("quizForm"),d=new bootstrap.Modal(document.getElementById("quizModal")),c=document.querySelector('meta[name="csrf-token"]').content;document.getElementById("open-add-quiz-modal").addEventListener("click",()=>{r.reset(),document.getElementById("quiz-id").value="",document.getElementById("quizModalLabel").textContent="Add Quiz",d.show()}),document.querySelectorAll(".edit-quiz").forEach(t=>{t.addEventListener("click",()=>{const o=t.dataset.id;fetch(`/dev/corpu2/simapeka/public/quizzes/${o}`).then(e=>e.json()).then(e=>{document.getElementById("quiz-id").value=e.id,document.getElementById("quiz-title").value=e.title,document.getElementById("quiz-points").value=e.points,document.getElementById("quiz-duration").value=e.duration,document.getElementById("quiz-status").value=e.status?"1":"0",document.getElementById("quizModalLabel").textContent="Edit Quiz",d.show()}).catch(e=>{console.error("Error:",e),alert("An error occurred while fetching quiz data. Please try again.")})})}),document.querySelectorAll(".delete-quiz").forEach(t=>{t.addEventListener("click",()=>{const o=t.dataset.id;confirm("Are you sure you want to delete this quiz?")&&fetch(`/dev/corpu2/simapeka/public/quizzes/${o}`,{method:"DELETE",headers:{"X-CSRF-TOKEN":c,"Content-Type":"application/json"}}).then(e=>e.json()).then(e=>{e.success?location.reload():alert(e.message||"Error deleting quiz")}).catch(e=>{console.error("Error:",e),alert("An error occurred. Please try again.")})})}),r.addEventListener("submit",t=>{t.preventDefault();const o=new FormData(r),e=o.get("id"),i=e?`/dev/corpu2/simapeka/public/quizzes/${e}`:"/dev/corpu2/simapeka/public/quizzes",u=e?"PUT":"POST";fetch(i,{method:"POST",body:o,headers:{"X-CSRF-TOKEN":document.querySelector('meta[name="csrf-token"]').getAttribute("content"),"X-HTTP-Method-Override":u}}).then(n=>n.json()).then(n=>{n.success?location.reload():alert(n.message||"Error saving quiz")}).catch(n=>{console.error("Error:",n),alert("An unexpected error occurred. Please try again.")})})});
